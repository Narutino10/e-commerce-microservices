# services/product-service
npm install --save-dev mongodb-memory-server @babel/core @babel/preset-env
npm install --save-dev mongodb-memory-server
npm install --save-dev cross-env
npm test
npm run lint

# services/order-service
npm test

# services/auth-service
npm test

# /frontend
npm run test
npm run test:unit
npm run test:coverage
npm run lint:report || true

# api produit
 curl -X POST http://localhost:3000/api/products \
  -d '{
    "name": " product hello",
    "price": 100,
    "description": "superproduit",     
    "stock": 10 
  }'
 curl -X POST http://product-service:3000/api/products \
  -d '{
    "name": "product hello",
    "price": 100,
    "description": "superproduit",
    "stock": 10 
  }'
# api authentification
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "password123"
  }'
# cart add 
 curl -X POST http://localhost:3000/api/cart/add \                                                                                                    
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer efrei_super_pass" \
  -H "userId: 67333c3e2095cb7f0a741b62" \                         
  -d '{   
    "userId": "67333c3e2095cb7f0a741b62",
    "productId": "672e4f620add9bcd996c2edb"
  }'     
  #order-service

# D'abord, obtenir un token d'authentification via le auth-service

TOKEN=$(curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}' \
  | jq -r '.token')

# Créer une commande
# Créer une commande
curl -X POST http://localhost:3002/api/orders \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "products": [{
      "productId": "672e4f620add9bcd996c2edb",
      "quantity": 1
    }],
    "shippingAddress": {
      "street": "123 Test St",
      "city": "Test City",
      "postalCode": "12345"
    }
  }'

# Récupérer les commandes
curl http://localhost:3002/api/orders \
  -H "Authorization: Bearer $TOKEN"

# Récupérer une commande spécifique
curl http://localhost:3002/api/orders/ID_COMMANDE \
  -H "Authorization: Bearer $TOKEN"